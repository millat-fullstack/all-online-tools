<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Color Picker | All Online Tools</title>
  <link rel="stylesheet" href="../css/home.css">
  <link rel="stylesheet" href="../css/suggested.css">
  
  <style>
  body {
    font-family: 'Inter', sans-serif;
    background: #f8f6fb;
    color: #2c2c2c;
    margin: 0;
    padding: 0;
    min-height: 100vh;
  }

  .page-container {
    padding: 40px;
    max-width: 900px;
    margin: 50px auto;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    text-align: center;
    box-sizing: border-box;
    position: relative;
    overflow: hidden;
    z-index: 1;
  }

  h1 { color: #6b4de6; }

.upload-zone {
  border: 2px dashed #a17edc;
  border-radius: 12px;
  padding: 30px;
  margin: 20px auto;
  background: #f8f6fb;
  cursor: pointer;
  max-width: 700px; /* increased from 500px */
}

  input[type="color"] {
    border: 1px solid #e8e0f5;
    width: 120px;
    height: 120px;
    border-radius: 10px;
    margin: 20px auto;
    display: block;
    cursor: pointer;
  }

canvas {
  margin-top: 20px;
  width: 100%; /* makes the canvas display larger while keeping original resolution */
  max-width: 100%;
  border: 1px solid #ddd;
  border-radius: 12px;
  display: none;
  cursor: crosshair;
  image-rendering: pixelated;
}

#magnifier {
  position: absolute;
  width: 140px;
  height: 140px;
  border: 2px solid #6b4de6;
  border-radius: 50%;
  display: none;
  pointer-events: none;
  background: #fff;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  z-index: 1000;
  image-rendering: pixelated;
}
  .tool-layout {
    display: flex;
    gap: 50px;
    margin-top: 20px;
  }

  .picker-left, .picker-right { flex: 1; }

  .codes { margin-top: 20px; text-align: left; }
  .code {
    background: #f8f6fb;
    border: 1px solid #e8e0f5;
    border-radius: 8px;
    padding: 12px 20px;
    margin: 10px 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: 'Courier New', monospace;
    font-size: 1.1em;
    box-sizing: border-box;
    margin-left: 40px;
  }

  button {
    padding: 6px 18px;
    background: #6b4de6;
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }
  button:hover { background: #593ac7; }
  </style>
</head>

<body>
  <div id="header"></div>

  <div class="page-container">
    <h1>ðŸŽ¨ Color Picker Tool</h1>
    <p>Upload, paste, or drag & drop an image. Hover to preview, click to pick a color.</p>

    <div class="tool-layout">
      <!-- Left Side -->
      <div class="picker-left">
        <div class="upload-zone" id="dropZone">
          <p>Click or drag & drop image here<br>Or paste screenshot (Ctrl+V)</p>
          <input type="file" id="imageInput" accept="image/*" hidden>
        </div>
        <input type="color" id="colorPicker" value="#a17edc">
        <canvas id="canvas"></canvas>
        <canvas id="magnifier" width="140" height="140"></canvas>
      </div>

      <!-- Right Side -->
      <div class="picker-right">
        <h3>Picked Color</h3>
        <div class="codes">
          <div class="code">
            <span id="hexCode">HEX: #a17edc</span>
            <button onclick="copyText('hexCode')">Copy</button>
          </div>
          <div class="code">
            <span id="rgbCode">RGB: 161, 126, 220</span>
            <button onclick="copyText('rgbCode')">Copy</button>
          </div>
          <div class="code">
            <span id="hslCode">HSL: 270, 50%, 67%</span>
            <button onclick="copyText('hslCode')">Copy</button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
const picker = document.getElementById("colorPicker");
const hexCode = document.getElementById("hexCode");
const rgbCode = document.getElementById("rgbCode");
const hslCode = document.getElementById("hslCode");

const dropZone = document.getElementById("dropZone");
const imageInput = document.getElementById("imageInput");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const magnifier = document.getElementById("magnifier");
const mtx = magnifier.getContext("2d");

// Upload
dropZone.addEventListener("click", () => imageInput.click());
imageInput.addEventListener("change", e => { 
  if (e.target.files[0]) loadImage(e.target.files[0]); 
});

// Drag & Drop
dropZone.addEventListener("dragover", e => e.preventDefault());
dropZone.addEventListener("drop", e => {
  e.preventDefault();
  if (e.dataTransfer.files[0]) loadImage(e.dataTransfer.files[0]);
});

// Paste
document.addEventListener("paste", e => {
  const items = e.clipboardData.items;
  for (let item of items) {
    if (item.type.startsWith("image/")) loadImage(item.getAsFile());
  }
});

function loadImage(file) {
  const img = new Image();
  img.onload = function() {
    // Resize canvas to fit image, max width 800px for easier color picking
    const maxWidth = 800;
    const maxHeight = 600;
    let width = img.width;
    let height = img.height;

    if (width > maxWidth) {
      const ratio = maxWidth / width;
      width = maxWidth;
      height = height * ratio;
    }
    if (height > maxHeight) {
      const ratio = maxHeight / height;
      height = maxHeight;
      width = width * ratio;
    }

    canvas.width = width;
    canvas.height = height;
    ctx.drawImage(img, 0, 0, width, height);
    canvas.style.display = "block";

    canvas.addEventListener("mousemove", showMagnifier);
    canvas.addEventListener("mouseleave", () => magnifier.style.display = "none");
    canvas.addEventListener("click", pickFromImage);
  };
  img.src = URL.createObjectURL(file);
}

function showMagnifier(e) {
  const rect = canvas.getBoundingClientRect();
  const scaleX = canvas.width / rect.width;
  const scaleY = canvas.height / rect.height;
  const x = Math.floor((e.clientX - rect.left) * scaleX);
  const y = Math.floor((e.clientY - rect.top) * scaleY);

  const zoom = 10;
  const size = magnifier.width / zoom;

  mtx.clearRect(0, 0, magnifier.width, magnifier.height);
  mtx.imageSmoothingEnabled = false;
  mtx.drawImage(canvas, x - size/2, y - size/2, size, size, 0, 0, magnifier.width, magnifier.height);

  // Crosshair
  mtx.strokeStyle = "red";
  mtx.lineWidth = 1;
  mtx.beginPath();
  mtx.moveTo(magnifier.width/2, 0);
  mtx.lineTo(magnifier.width/2, magnifier.height);
  mtx.stroke();
  mtx.beginPath();
  mtx.moveTo(0, magnifier.height/2);
  mtx.lineTo(magnifier.width, magnifier.height/2);
  mtx.stroke();

  magnifier.style.display = "block";

  // Offset slightly right + down, but keep inside viewport
  const offset = 15;
  let left = e.clientX + offset;
  let top = e.clientY + offset;

  if (left + magnifier.width > window.innerWidth) {
    left = e.clientX - magnifier.width - offset;
  }
  if (top + magnifier.height > window.innerHeight) {
    top = e.clientY - magnifier.height - offset;
  }

  magnifier.style.left = `${left}px`;
  magnifier.style.top = `${top}px`;
}

function pickFromImage(e) {
  const rect = canvas.getBoundingClientRect();
  const scaleX = canvas.width / rect.width;
  const scaleY = canvas.height / rect.height;
  const x = Math.floor((e.clientX - rect.left) * scaleX);
  const y = Math.floor((e.clientY - rect.top) * scaleY);

  const pixel = ctx.getImageData(x, y, 1, 1).data;
  const hex = rgbToHex(pixel[0], pixel[1], pixel[2]);
  picker.value = hex;
  updateCodes(hex);
}

picker.addEventListener("input", () => updateCodes(picker.value));

function updateCodes(hex) {
  hexCode.textContent = "HEX: " + hex.toUpperCase();
  let rgb = hexToRgb(hex);
  rgbCode.textContent = `RGB: ${rgb.r}, ${rgb.g}, ${rgb.b}`;
  let hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
  hslCode.textContent = `HSL: ${hsl.h}, ${hsl.s}%, ${hsl.l}%`;
}

function rgbToHex(r,g,b){return"#"+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1);}
function hexToRgb(hex){let r=parseInt(hex.slice(1,3),16);let g=parseInt(hex.slice(3,5),16);let b=parseInt(hex.slice(5,7),16);return{r,g,b};}
function rgbToHsl(r,g,b){
  r/=255;g/=255;b/=255;
  let max=Math.max(r,g,b),min=Math.min(r,g,b);
  let h,s,l=(max+min)/2;
  if(max===min){h=s=0;}else{
    let d=max-min;
    s=l>0.5?d/(2-max-min):d/(max+min);
    switch(max){case r:h=(g-b)/d+(g<b?6:0);break;
    case g:h=(b-r)/d+2;break;
    case b:h=(r-g)/d+4;break;}
    h/=6;
  }
  return{h:Math.round(h*360),s:Math.round(s*100),l:Math.round(l*100)};
}

function copyText(id){
  const text=document.getElementById(id).textContent.split(": ")[1];
  navigator.clipboard.writeText(text);
  alert("Copied: "+text);
}
</script>

  <!-- Extra Sections -->

<section id="suggested-tools">
  <h2>Suggested Tools</h2>
  <div class="suggested-list"></div>
</section>

<script src="../js/suggested.js"></script>


  <div id="footer"></div>
<script src="../js/include.js"></script>
<script src="../js/search.js"></script>

</body>
</html>
